# ORM Performance Benchmark

TypeScript + Node.js í™˜ê²½ì—ì„œ **Sequelize**, **Prisma**, **TypeORM**, **Drizzle** ë„¤ ê°œì˜ ì£¼ìš” ORMì„ ì‹¤ì œ **í”¼ë¶€ê³¼ CRM ì‹œìŠ¤í…œ**ìœ¼ë¡œ ëª¨í‚¹í•˜ì—¬ ì„±ëŠ¥ì„ ë¹„êµ ë¶„ì„í•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ

- **ì‹¤ì „ í™˜ê²½**: ì‹¤ì œ CRM ì‹œìŠ¤í…œì˜ ë³µì¡í•œ ë„ë©”ì¸ ëª¨ë¸ê³¼ ê´€ê³„ë¥¼ ë°˜ì˜
- **ëŒ€ìš©ëŸ‰ ë°ì´í„°**: 10ë§Œê±´ ìˆ˜ì¤€ì˜ ë°ì´í„°ë¡œ ì‹¤ì œ ìš´ì˜ í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜
- **ì¢…í•©ì  í‰ê°€**: CRUD ì„±ëŠ¥, íŠ¸ëœì­ì…˜ ì²˜ë¦¬, ë³µì¡ ì¿¼ë¦¬, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë“± ë‹¤ê°ë„ ë¶„ì„
- **ê°ê´€ì  ë¹„êµ**: ë™ì¼í•œ í™˜ê²½ê³¼ ì¡°ê±´ì—ì„œ ê³µì •í•œ ì„±ëŠ¥ ë¹„êµ

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ë„ë©”ì¸ ëª¨ë¸ (í”¼ë¶€ê³¼ CRM)

```bash
Patient (í™˜ì)
â”œâ”€â”€ 1:N Reservation (ì˜ˆì•½)
â”œâ”€â”€ 1:N MedicalRecord (ì§„ë£Œê¸°ë¡)
â”‚   â””â”€â”€ 1:N Treatment (ì‹œìˆ )
â””â”€â”€ 1:N Payment (ê²°ì œ)
```

### ì£¼ìš” ì—”í‹°í‹°

- **Patient**: í™˜ì ì •ë³´ (ì´ë¦„, ì„±ë³„, ì—°ë½ì²˜, ì²«ë°©ë¬¸ì¼ ë“±)
- **Reservation**: ì˜ˆì•½ ì •ë³´ (ì˜ˆì•½ì¼ì‹œ, ì§„ë£Œê³¼, ë‹´ë‹¹ì˜ ë“±)
- **MedicalRecord**: ì§„ë£Œê¸°ë¡ (ì¦ìƒ, ì§„ë‹¨, ì²˜ë°© ë“±)
- **Treatment**: ì‹œìˆ  ì •ë³´ (ì‹œìˆ ëª…, ê°€ê²©, ì†Œìš”ì‹œê°„ ë“±)
- **Payment**: ê²°ì œ ì •ë³´ (ê¸ˆì•¡, ê²°ì œë°©ë²•, ê²°ì œìƒíƒœ ë“±)

### ë‹¤ì´ì–´ê·¸ë¨

```mermaid
erDiagram
    Patient {
        int id PK
        string name
        string gender
        string phone
        date birth_date
        date first_visit_at
        date last_visit_at
    }

    Reservation {
        int id PK
        int patient_id FK
        datetime reserved_at
        string department
        string doctor
        string status
    }

    MedicalRecord {
        int id PK
        int patient_id FK
        date visit_date
        string doctor
        string symptoms
        string diagnosis
        string prescription
    }

    Treatment {
        int id PK
        int record_id FK
        string treatment_name
        decimal price
        int duration
        datetime started_at
        datetime ended_at
    }

    Payment {
        int id PK
        int patient_id FK
        int treatment_id FK
        decimal amount
        string method
        string status
        datetime paid_at
        string receipt_number
    }

    Patient ||--o{ Reservation : "has(ì˜ˆì•½)"
    Patient ||--o{ MedicalRecord : "has(ì§„ë£Œ)"
    Patient ||--o{ Payment : "has(ê²°ì œ)"
    MedicalRecord ||--o{ Treatment : "has(ì§„ë£Œ)"
```

## seed ë°ì´í„° ì˜ˆìƒ ë¶„í¬

- í™˜ì: 100,000ëª…
- ì˜ˆì•½: ì•½ 825,000ê±´ (í‰ê·  8.25ê±´/í™˜ì)
- ì§„ë£Œê¸°ë¡: ì•½ 550,000ê±´ (í‰ê·  5.5ê±´/í™˜ì)
- ì‹œìˆ : ì•½ 550,000ê±´ (ì§„ë£Œê¸°ë¡ê³¼ 1:1)
- ê²°ì œ: ì•½ 550.000ê±´ + 10% (ì˜ˆì•½ ê¸°ë°˜ + 10% ë³µì¡ ì‹œë‚˜ë¦¬ì˜¤)

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

- **Runtime**: Node.js 22.19.0
- **Language**: TypeScript 5.5.2
- **Database**: PostgreSQL 15 (Docker)
- **ORMs**: Sequelize `6.37.3`, Prisma `6.15.0`, TypeORM `0.3.20`, Drizzle `0.44.5`
- **Testing**: Faker.js 8.4.1 (ë°ì´í„° ìƒì„±), CLI Table 0.6.4 (ê²°ê³¼ ì¶œë ¥)
- **Build Tools**: Drizzle Kit 0.31.4, ts-node 10.9.2

## ğŸ“¦ ì„¤ì¹˜ ë° ì„¤ì •

### 1. í”„ë¡œì íŠ¸ í´ë¡ 

```bash
git clone <repository-url>
cd orm-benchmark
```

### 2. í™˜ê²½ ì„¤ì •

```bash
mkdir env
cp env.template env/local.env
```

### 3. ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°´ì¹˜ë§ˆí¬ í™˜ê²½ ì…‹íŒ…

```bash
# npm ì˜ì¡´ì„± & ì»¨í…Œì´ë„ˆ ìƒì„± & ormë³„ ë§ˆì´ê·¸ë ˆì´ì…˜ & seed ë°ì´í„° ì£¼ì…
sh setup.sh
```

### 4. ë°´ì¹˜ë§ˆí¬ ì‹œì‘

```bash
## ìˆœì°¨ì ìœ¼ë¡œ ì¼ê´„ ìˆ˜í–‰
npm run benchmark:all

## ê°ê° ìˆ˜í–‰
npm run benchmark:sequelize
npm run benchmark:prisma
npm run benchmark:typeorm
npm run benchmark:drizzle
```

### 5. í™˜ê²½ ì •ë¦¬

```bash
# ì»¨í…Œì´ë„ˆ ë³¼ë¥¨ ì œê±° ë° ì»¨í…Œì´ë„ˆ ì¢…ë£Œ/ì œê±°
sh reset.sh
```

## ğŸš€ ìƒì„¸ ì‚¬ìš©ë²•

### ì „ì²´ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰

```bash
# ëª¨ë“  ORM ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
npm run benchmark:all

# ë˜ëŠ” íŠ¹ì • ORMë§Œ ì‹¤í–‰
npm run benchmark:sequelize
npm run benchmark:prisma
npm run benchmark:typeorm
npm run benchmark:drizzle
```

### ì‹œë“œ ë°ì´í„° ìƒì„±

```bash
# ëª¨ë“  ORMì— ì‹œë“œ ë°ì´í„° ìƒì„± (ê¸°ë³¸ 10ë§Œê±´)
npm run db:seed:all

# ë˜ëŠ” ê°œë³„ ì‹¤í–‰
npm run db:seed:sequelize
npm run db:seed:prisma
npm run db:seed:typeorm
npm run db:seed:drizzle
```

### í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```bash
# env/local.env íŒŒì¼ì—ì„œ ì„¤ì • ê°€ëŠ¥
BENCHMARK_TOTAL_RECORDS=100000  # ìƒì„±í•  ì´ í™˜ì ìˆ˜
BENCHMARK_BATCH_SIZE=1000       # ë°°ì¹˜ ì²˜ë¦¬ ë‹¨ìœ„
BENCHMARK_CONCURRENCY=10        # ë™ì‹œ ì²˜ë¦¬ ìˆ˜
BENCHMARK_REPORT_MODE=files     # ë¦¬í¬íŠ¸ ëª¨ë“œ (file, console, all)
PRISMA_SEED_MODE=flat          # Prisma ì‹œë“œ ëª¨ë“œ (flat, nested)
```

## ğŸ“Š ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸ í•­ëª©

### 1. ë‹¨ìˆœ ì½ê¸° (Simple Read)

- **ëª©ì **: ê¸°ë³¸ì ì¸ SELECT ì„±ëŠ¥ ì¸¡ì •
- **í…ŒìŠ¤íŠ¸**: í™˜ì ë°ì´í„° 1,000ê±´ / 10,000ê±´ ì¡°íšŒ (í˜ì´ì§•)
- **ì¸¡ì •**: ì‘ë‹µì‹œê°„, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

### 2. ë‹¨ìˆœ ì“°ê¸° (Simple Write)

- **ëª©ì **: ëŒ€ëŸ‰ INSERT ì„±ëŠ¥ ì¸¡ì •
- **í…ŒìŠ¤íŠ¸**: í™˜ì ë°ì´í„° 1,000ê±´ / 5,000ê±´ ì¼ê´„ ì‚½ì…
- **ì¸¡ì •**: ì²˜ë¦¬ì‹œê°„, ì´ˆë‹¹ ì²˜ë¦¬ê±´ìˆ˜ (TPS)

### 3. ë³µì¡ íŠ¸ëœì­ì…˜ (Complex Transaction)

- **ëª©ì **: ì‹¤ì „ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ íŠ¸ëœì­ì…˜ ì„±ëŠ¥
- **í…ŒìŠ¤íŠ¸**: í™˜ì ë“±ë¡ + ì˜ˆì•½ + ì§„ë£Œê¸°ë¡ + ì‹œìˆ  + ê²°ì œ (100/500ê±´)
- **ì¸¡ì •**: íŠ¸ëœì­ì…˜ ì™„ë£Œì‹œê°„, ì‹¤íŒ¨ìœ¨

### 4. ë‹¨ìˆœ í†µê³„ (Simple Stats)

- **ëª©ì **: ì§‘ê³„ ì¿¼ë¦¬ ì„±ëŠ¥
- **í…ŒìŠ¤íŠ¸**: ìµœê·¼ 30ì¼ ì¼ë³„ ì‹ ê·œ í™˜ì ìˆ˜ ì¡°íšŒ
- **ì¸¡ì •**: ì¿¼ë¦¬ ì‹¤í–‰ì‹œê°„

### 5. ë³µì¡ í†µê³„ (Complex Stats)

- **ëª©ì **: ë³µì¡í•œ JOINê³¼ ì§‘ê³„ ì„±ëŠ¥
- **í…ŒìŠ¤íŠ¸**: ì˜ì‚¬ë³„ ì‹œìˆ  ë§¤ì¶œ ìˆœìœ„ (TOP 10)
- **ì¸¡ì •**: ë³µì¡ ì¿¼ë¦¬ ì‹¤í–‰ì‹œê°„

### 6. ì¤‘ì²© ì‚½ì… (Nested Insert)

- **ëª©ì **: ë³µì¡í•œ ê´€ê³„í˜• ë°ì´í„° ì¼ê´„ ì‚½ì… ì„±ëŠ¥
- **í…ŒìŠ¤íŠ¸**: í™˜ì + ì˜ˆì•½ + ì§„ë£Œê¸°ë¡ + ì‹œìˆ  + ê²°ì œë¥¼ í•œë²ˆì— ìƒì„± (100/500ê±´)
- **ì¸¡ì •**: ì¤‘ì²© ì‚½ì… ì²˜ë¦¬ì‹œê°„, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

### 7. ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸ (Bulk Update)

- **ëª©ì **: UPDATE ì„±ëŠ¥ ì¸¡ì •
- **í…ŒìŠ¤íŠ¸**: í™˜ì 1,000ê±´ ë§ˆì§€ë§‰ ë°©ë¬¸ì¼ ì—…ë°ì´íŠ¸
- **ì¸¡ì •**: ì—…ë°ì´íŠ¸ ì²˜ë¦¬ì‹œê°„

### 8. ëŒ€ëŸ‰ ì‚­ì œ (Bulk Delete)

- **ëª©ì **: DELETE ì„±ëŠ¥ ì¸¡ì •
- **í…ŒìŠ¤íŠ¸**: 1ë…„ ì´ìƒ ëœ í™˜ì ë°ì´í„° ì‚­ì œ (í˜„ì¬ ë¹„í™œì„±í™”)
- **ì¸¡ì •**: ì‚­ì œ ì²˜ë¦¬ì‹œê°„, CASCADE ì„±ëŠ¥

## ğŸ“ˆ ê²°ê³¼ ë¦¬í¬íŠ¸

ë²¤ì¹˜ë§ˆí¬ ì™„ë£Œ í›„ ë‹¤ìŒ í˜•íƒœë¡œ ê²°ê³¼ê°€ ìƒì„±ë©ë‹ˆë‹¤:

### ì½˜ì†” ì¶œë ¥

```
ğŸ“Š ORM Performance Benchmark Results
================================================================================

ğŸ”§ Sequelize Results:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Operation                           â”‚ Duration (ms)   â”‚ Records    â”‚ Avg/Record (ms)  â”‚ Memory (MB)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Simple Read (limit: 1000)           â”‚ 45.32           â”‚ 1,000      â”‚ 0.0453           â”‚ 12.45         â”‚
â”‚ Simple Write (1000 records)         â”‚ 234.56          â”‚ 1,000      â”‚ 0.2346           â”‚ 18.92         â”‚
...
```

### íŒŒì¼ ì¶œë ¥

- **JSON**: `results/{orm}-{timestamp}.json` - ìƒì„¸ ê²°ê³¼ ë°ì´í„°
- **CSV**: `results/{orm}-{timestamp}.csv` - ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë¶„ì„ìš©
- **Markdown**: `results/{orm}-{timestamp}.md` - ë³´ê³ ì„œ í˜•íƒœ
- **Console**: ì‹¤ì‹œê°„ ì½˜ì†” ì¶œë ¥ (í…Œì´ë¸” í˜•íƒœ)

## ğŸ”§ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
orm-benchmark/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/           # ê³µí†µ íƒ€ì… ì •ì˜
â”‚   â”œâ”€â”€ utils/           # ìœ í‹¸ë¦¬í‹° (DBì—°ê²°, Faker, ì„±ëŠ¥ì¸¡ì •)
â”‚   â”œâ”€â”€ benchmark/       # ë²¤ì¹˜ë§ˆí¬ ê¸°ë³¸ í´ë˜ìŠ¤ ë° ë¦¬í¬í„°
â”‚   â””â”€â”€ orm/
â”‚       â”œâ”€â”€ sequelize/   # Sequelize êµ¬í˜„
â”‚       â”‚   â”œâ”€â”€ models/     # ëª¨ë¸ ì •ì˜
â”‚       â”‚   â”œâ”€â”€ config.ts   # DB ì„¤ì •
â”‚       â”‚   â”œâ”€â”€ migrate.ts  # ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚       â”‚   â”œâ”€â”€ seed.ts     # ì‹œë“œ ë°ì´í„°
â”‚       â”‚   â””â”€â”€ benchmark.ts # ë²¤ì¹˜ë§ˆí¬
â”‚       â”œâ”€â”€ prisma/      # Prisma êµ¬í˜„
â”‚       â”œâ”€â”€ typeorm/     # TypeORM êµ¬í˜„
â”‚       â””â”€â”€ drizzle/     # Drizzle êµ¬í˜„
â”œâ”€â”€ env/                 # í™˜ê²½ë³€ìˆ˜ ì„¤ì •
â”œâ”€â”€ scripts/            # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ results/            # ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼
â”œâ”€â”€ docker-compose.yml  # PostgreSQL ì»¨í…Œì´ë„ˆ
â””â”€â”€ package.json        # ìŠ¤í¬ë¦½íŠ¸ ë° ì˜ì¡´ì„±
```

## ğŸ“‹ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ORM ì¶”ê°€

1. `src/orm/{orm_name}/` ë””ë ‰í† ë¦¬ ìƒì„±
2. `BaseBenchmark`ë¥¼ ìƒì†í•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ í´ë˜ìŠ¤ êµ¬í˜„
3. ë™ì¼í•œ ë„ë©”ì¸ ëª¨ë¸ ì •ì˜
4. `package.json`ì— ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

### ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ì¶”ê°€

1. `BaseBenchmark`ì— ì¶”ìƒ ë©”ì„œë“œ ì¶”ê°€
2. ê° ORMë³„ êµ¬í˜„ì²´ì—ì„œ ë©”ì„œë“œ êµ¬í˜„
3. `runAll()` ë©”ì„œë“œì— í…ŒìŠ¤íŠ¸ ì¶”ê°€

### ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸

```bash
# ê°œë°œ ëª¨ë“œ ì‹¤í–‰
npm run start:dev

# ë””ë²„ê·¸ ëª¨ë“œ ì‹¤í–‰
npm run start:debug

# Prisma Studio ì‹¤í–‰
npm run studio:prisma

# Drizzle Studio ì‹¤í–‰
npm run studio:drizzle

# Prisma ë¦¬ì…‹
npm run db:reset:prisma

# Drizzle ìŠ¤í‚¤ë§ˆ ìƒì„±
npm run db:generate:drizzle

# Drizzle ìŠ¤í‚¤ë§ˆ í‘¸ì‹œ
npm run db:push:drizzle
```

## ğŸš¨ ì£¼ì˜ì‚¬í•­

- **ëŒ€ìš©ëŸ‰ ë°ì´í„°**: 10ë§Œê±´ ì‹œë“œ ìƒì„±ì‹œ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (5-10ë¶„)
- **DB ì—°ê²°**: PostgreSQL ì»¨í…Œì´ë„ˆê°€ ì™„ì „íˆ ì‹œì‘ëœ í›„ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•˜ì„¸ìš”
- **ìŠ¤í‚¤ë§ˆ ë¶„ë¦¬**: ê° ORMì€ ë³„ë„ ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©í•˜ì—¬ ê²©ë¦¬ë©ë‹ˆë‹¤
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰ì‹œ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤ (ìµœì†Œ 4GB ê¶Œì¥)
- **ë¦¬í¬íŠ¸ ëª¨ë“œ**: `BENCHMARK_REPORT_MODE` í™˜ê²½ë³€ìˆ˜ë¡œ ì¶œë ¥ ë°©ì‹ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- **Prisma ì‹œë“œ**: `PRISMA_SEED_MODE`ë¡œ flat/nested ì‹œë“œ ë°©ì‹ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
